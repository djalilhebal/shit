// to download a friend's webcomic ;-;
const cheerio = require('cheerio');
const fetch = require('fetch').fetchUrl;
const execSync = require('child_process').execSync;

/*
// perform this on any page of the webcomic
const ids = [];
const options = $('#dropdownholder select option');
for (let i = 0; i < options.length; i++) ids.push(options[i].value);
*/
const ids = ['5564679','5564651','5564604','5564584','5564529','5564523','5564500','5564392','5563337','5563238','5563191','5563044','5562921','5562849','5562781','5562607','5562503','5562020','5561790','5561050','5559329','5559326','5559288','5559163','5559080','5559000','5558946','5558582','5558581','5558329','5558268','5558204','5558064','5557867','5557561','5557396','5557370','5555840','5555757','5555711','5555512','5551888','5551787','5551737','5551722','5551670','5551543','5551145','5551051','5550990','5548655','5548612','5548541','5548204','5548097','5548015','5547955','5547873','5547435','5547302','5547225','5547199','5547137','5547070','5545265','5545264','5545263','5545262','5545261','5545260','5545259','5545258','5545257','5545256','5545255','5545254','5545253','5545252','5545251','5545250','5545249','5545248','5545247','5545245','5545244','5545243','5545242','5545241','5545240','5545239','5545238','5545237','5545236','5545235','5545234','5545233','5545232','5545231','5545230','5545229','5545228','5545227','5545226','5545161','5545160','5545159','5545158','5545157','5545156','5545155','5545154','5545153','5545152','5545151','5545150','5545149','5545148','5545147','5545146','5545145','5545144','5545143','5545142','5545141','5545140','5545139','5545138','5545137','5545136','5545135','5545134','5545133','5545132','5545131','5545130','5545129','5545128','5545127','5545126','5545125','5545124','5545123','5545122','5545121','5545120'];

const bad = [];
for (let i = 0; i < ids.length; i++) {
	const id = ids[i];
	const url = 'http://www.theduckwebcomics.com/Road_to_heaven/' + id + '/';
	fetch(url, function(err, meta, body) {
		if (err) {
			console.log('ERR: ', id);
			bad.push(id);
		} else {
			const $ = cheerio.load(body);
			const src = $('meta')[2].attribs.content; // the img's src
			const cmd = 'aria2c ' + src + ' -o RTH_' + id + '.jpg';
			console.log('Getting: ', id);
			execSync(cmd);
		}
	});	
}

if (bad.length > 0) {
	console.log('BAD: ', JSON.stringify(bad));
}
